<link rel="stylesheet" href="../textarea.css">

<style>
  textarea {
    height: 20vh;
  }
</style>

<workspace>
  <focus></focus>
  <blur></blur>
</workspace>

<script>

  // var workspace = {
  //   focus: [],
  //   blur: []
  // };

  // var item = {
  //   content: ""
  // };

  // item.content = new Workspace(item);

  // if (typeof item.content == "object") {
  //   // workspace
  // } else {
  //   // end content
  // }

  // Note

  function Content (content) {
    this.content = content;
  }

  function Workspace (content) {
    // content.constructor.call(this, content);
    this.focused = [content];
    this.blurred = [];
    this.content = content.constructor;
  }

  Workspace.prototype.blur = function (item) {
    if (item) {
      this.blurred.push(item);
      if (this.focused.indexOf(item) > -1) {
        this.focused.splice(this.focused.indexOf(item), 1);
      }
    }
  }

  Workspace.prototype.focus = function (item) {
    if (item) {
      this.focused.push(item);
      if (this.blurred.indexOf(item) > -1) {
        this.blurred.splice(this.blurred.indexOf(item), 1)
      }
    }
  }

  Workspace.prototype.clear = function () {
    while(this.focused.length > 0) this.blurred.push(this.focused.pop());
  }

  Workspace.prototype.new = function (content) {
    this.clear();
    this.focus(new this.content(content));
  }

  // var note = new Content("zak");
  var notespace = new Workspace(new Content("zok"));
  notespace.clear();
  var vitla = new notespace.content("Vitla");
  notespace.focus(vitla);
  var mokla = new notespace.content("Mokla");
  notespace.focus(mokla);


  // var textarea = document.querySelector("textarea");
  // textarea.addEventListener("change", function () {
  //   var note = document.createElement("note");
  //   note.innerHTML = this.value;
  //   document.querySelector("list").appendChild(note);
  // });

  // var workspace = {
  //   element: document.querySelector("workspace"),
  //   focus: function (item) {
  //     this.focused.appendChild(item);
  //   },
  //   focused: {
  //     element: document.querySelector("workspace focus"),
  //   },
  //   blur: function () {
  //     this.blurred.element.appendChild(this.focused.element.children[0]);
  //   },
  //   blurred: {
  //     element: document.querySelector("workspace blur");
  //   }
  // }

  // // model
  // var workspace = {
  //   focus: {},
  //   blur: {}
  // };

  // // view
  // var workspace = document.querySelector("workspace"),
  //   focus = workspace.querySelector("focus"),
  //   blur = workspace.querySelector("blur");

  // persist (store/save)
  // ... firebase?

  // commands user

  // initial load (user command?)

  // each THING has aspects - viewable, persistable, interactable (user action)

  // Моделируем

  // function Note () {
  //   return document.createElement("textarea");
  // }




  // function focus (item) {
  //   document.querySelector("workspace focus").appendChild(item);
  // }

  // focus(new Note());

  // function blur () {
  //   var b = document.querySelector("workspace blur");
  //   var f = document.querySelector("workspace focus");
  //   b.appendChild(f.children[0]);
  // }

  // document.querySelector("workspace focus").addEventListener("keydown", function (event) {
  //   if (event.ctrlKey && event.keyCode == 13) { // ctrl + enter
  //     blur();
  //     focus(new Note());
  //   }
  // });

  // // Utils, dictionary/language

  // // Content vs Workspace

  // function Content () {
  //   return null;
  // }

  // function Workspace (workspace) {
  //   this.focus = workspace ? [workspace] : [];
  //   this.blur = [];
  // }

  // Workspace.prototype.next = function (content) {
  //   // blur focused
  //   while(this.focus.length > 0) {
  //     this.blur.push(this.focus.pop());
  //   }
  //   // focus new
  //   this.focus.push(new Workspace());
  // };

  // // Note content vs Notes workspace

  // function Note (text) {
  //   this.content = text ? text : "";
  // }

  // var note = new Note("");
  // note.content("Hello, world");
  // newNote()

  // Notes.prototype = Object.create(Workspace.prototype);

  // Notes.prototype.next = function () {
  //   this.blur.push(this.focus);
  //   this.focus = new Note();
  // };

  // Expand from null

  // function meta (item, workspace) {
  //   // new workspace
  //   var workspace = new Workspace ();
  //   // blur
  //   workspace.blur.push(this);
  //   workspace.focus(new Content());
  //   return workspace;
  // }

  // function metaFromWorkspace () {
  //   var workspace = new Workspace(workspace);
  //   workspace.next();
  // }

  // function meta (currentWorkspace, newWorkspaceCallback) {
  //   // оборачиваем "текущее" в фокус.
  //   var focus = [currentWorkspace];
  //   // создаем рядом блюр
  //   var workspace = {
  //     focus: focus,
  //     blur: []
  //   }
  //   // кладем содержимое фокуса в блюр
  //   while(workspace.focus.length > 0) {
  //     workspace.blur.push(workspace.focus.shift());
  //   };
  //   // создаем свежее в текущем фокусе
  //   workspace.focus.push(newWorkspaceCallback());
  // }


  // function Workspace (workspace) {
  //   this.focus = workspace;
  //   this.blur = [];
  // }

</script>
