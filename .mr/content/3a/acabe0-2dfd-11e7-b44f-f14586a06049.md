# Файловая версия (CLI или FileSystem)

Мы должны мочь пропарсить заметку или журнал (несколько заметок в одном файле) в общую для данного проекта "базу данных" на диске. Должны мочь сформировать из этой "базы данных", например, заметки за последний месяц или заметки по данной теме/проекту, сохранив это, например, в файл (txt/md/pfd) или выведя на экран.

Чтоб парсинг в базу стал возможным, нужен [формат исходной заметки или журнала](формат пользовательской заметки.md). Внутри базы мы также храним заметки в [определённом формате](формат базы данных.md).


# Туду 1

Парсинг в базу происходит через pipe [потоков] (как в [gulp]).

1. (input/transform) Компонент, "чистящий" заметку/журнал от лишних пробелов и прочего мусора - подготовка идеально сформатированной заметки/журнала. Компонент читает построчно и отдаёт построчно.
2. (input/transform) Компонент, принимающий строку (заметку или журнал в будущем) и отдающий заметки. Версия через Stream (как в gulp) и обычная (отдаёт массив).
3. (view) Компонент, выдающий заметки на экран
4. (view) Компонент, сохраняющий заметки в раздельные файлы в папку куда скажу
5. (view) Компонент, сохраняющий заметки в один файл, какой скажу.

[потоков]:https://nodejs.org/api/stream.html
[gulp]:http://gulpjs.com/

# ТУДУ 2

- Мы парсим файл с одной заметкой или журнал с несколькими заметками и складываем их в нашу базу данных.
- Выводить заметки мы можем в виде структуры файлов в Markdown-формате с отдельным файлом-содержанием или даже всё-в-одном PDF-файле.
- "Выводить" и "Хранить" одна и та же операция, возможно с флагом "clean". Для самой базы данных много сопутсвующей информации, идентификаторов, ссылок. Для вывода же "набело" эту служебную информацию можно опустить.

# Сценарии

- я "парсю" заметку (файл, лежащий неважно в какой папке на на диске). И он попадает в "общую базу".
  - Где располагается "общая база"?

    Когда я создаю "где-то" файлик (заметку или журнал заметок), подразумеваю уже (скорей всего) что он (его расположение) относится к какому-то проекту, к какой-то теме. Какая-то из его родительских папок является папкой этой темы, проекта. У него есть имя, у него есть связи с другими сущностями (клиенты или другие проекты по ассоциации). Стало быть там нужен файлик описания проекта (контекста) в котором я создаю свою заметку (первый файлик). Это может быть анонимный (корневой) проект, без названия. Это происходит в начале когда по сути у меня только пара заметок - зачем там проект, там просто три заметки "в корне". Стало "файлик проекта" - это скорей папка проекта с файликами заметок и индексами. К ней может быть а может и не быть файла настройки по аналогии с package.json. Если у нас нет необходимости хранить заметки в этом одном хранилище - наш сервис не создаётся. Если есть всего одна заметка - наш сервис не нужен. Только начиная с двух заметок (в одном ли файле или в разных) начинается наш сервис. С другой стороны - файл индекса (порядок) заметок пока не нужен - пока нет необходимости в порядке.

  - Формат хранения заметки в общей базе
    - имя файла не имеет значения

  - Название общей базы

  - второй раз "пропарсив" заметку, сервис должен понять что это та же самая, а не новая заметка.
    - Хеш содержания (чтоб совпадал если совпадает контент)
    - путь к файлу в соотв. поле базы данных

- экспорт "базы данных" (по сути доступ к ней) так же в виде файлов и содержания, возможно даже HTML и PDF

- экспортированная "база данных" возможно по сути - копия исходной.. Как копии репозиториев git. А, вот, разница в пути файлов например, связанных с базой данных (если я хочу отслеживать их) - эти пути будут вести уже к новым файлам.

<!-- {"date":"2016-10-22T12:08:11.528Z","group":"Сервис заметок","archive":true,"id":"3aacabe0-2dfd-11e7-b44f-f14586a06049","excerpt":"Мы должны мочь пропарсить заметку или журнал..."} -->